<!DOCTYPE html><html domain=thefortunedays.com lang=en><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href="/img/favicon/favicon-192x192.png?hash=735479e2c4" rel=icon type=image/png><meta content=#ff577d name=theme-color><meta content="max-snippet:-1, max-image-preview: large, max-video-preview: -1" name=robots><title>Interface Explained</title><meta content="Interface Explained" property=og:title><meta content="A little bit deep inside Go interface{}." name=description><meta content="A little bit deep inside Go interface{}." property=og:description><meta content=summary_large_image name=twitter:card><meta content=@phamthethanh108 name=twitter:site><meta content=@phamthethanh108 name=twitter:creator><meta content=https://thefortunedays.com/img/remote/Z1o6V9l.jpg property=og:image><link href=https://thefortunedays.com/articles/go-interface/ rel=canonical><meta content=no-referrer-when-downgrade name=referrer><link href=/feed/feed.xml rel=alternate type=application/atom+xml title="The Fortune Days"><link href=/ rel=preconnect crossorigin=""><link href=/fonts/CyberwayRiders.woff2 rel=preload crossorigin="" as=font type=font/woff2><link href=https://fonts.googleapis.com rel=preconnect><link href=https://fonts.gstatic.com rel=preconnect crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel=stylesheet><script async src="/js/min.js?hash=8db32dcb3a" data-cwv-src="/js/web-vitals.js?hash=4a3c7b61e1" defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-9X9G2YCR2X"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-9X9G2YCR2X');</script><script csp-hash="">if (/Mac OS X/.test(navigator.userAgent))document.documentElement.classList.add('apple')</script><style>:root{--primary: #ff577d;--primary-dark:#ff184c;--text-color: #F5F5F7;--bg-color: 	#003062;--nav-bg-color: #ff577d;--nav-text-color: #fff;--footer-bg-color: #091833;--footer-text-color: #999;--main-width: calc(100vw - 3em)}main img{content-visibility:auto}article *{scroll-margin-top:50px}header nav{position:fixed;padding:.575em 1.5em;background:var(--nav-bg-color);color:var(--nav-text-color);font-weight:200;text-align:right}@media (min-width:37.5em){:root{--main-width: calc(37.5em - 3em)}}dialog,share-widget{position:fixed;opacity:.9}share-widget{right:20px;bottom:20px}share-widget div{width:20px;height:20px;background-image:url(/img/share.svg);background-repeat:no-repeat;background-position:center}.apple share-widget div{background-image:url(/img/share-apple.svg)}body,share-widget button{margin:0}share-widget button:active{transform:scale(1.2)}dialog{background-color:#0a9cf5;z-index:1000}#nav{z-index:2;position:relative}#reading-progress,header nav{z-index:1;width:100vw;left:0;top:0}#reading-progress{background-color:var(--primary);position:absolute;bottom:0;transform:translate(-100vw,0);will-change:transform;pointer-events:none}@font-face{font-display:optional;font-family:"CyberwayRiders";font-weight:100 900;font-style:oblique 0deg 10deg;src:url(/fonts/CyberwayRiders.woff2) format("woff2");font-display:swap}button,html{line-height:1.15}html{-webkit-text-size-adjust:100%;font-size:17.5px}@media (max-width:768px){html{font-size:14px}}pre{font-size:1em}a{background-color:transparent;color:#f9c412;text-decoration:none;color:var(--primary)}strong{font-weight:700}img{border-style:none;max-width:100%;height:auto;margin:0 auto}button{font-family:inherit;font-size:100%;overflow:visible;text-transform:none}[type=button],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}h1{margin:3rem 0 1.38rem;line-height:1.3;font-size:2.488rem;font-family:var(--font-family)}body,p,pre{font-size:1rem;line-height:1.6}p,pre{margin-bottom:1.36rem}table{display:table}code,pre,table{overflow-x:auto}pre{font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace}pre:has(code:not([class])){background:#2d2d2d}pre code:not([class]){color:#ccc;padding:0;overflow-x:scroll}button,code{border-radius:.3em}code{color:#e2777a;padding:0 .3em;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:90%;background:#2d2d2d}a:hover{text-decoration:underline}@media (max-width:767px){x:-moz-any-link{display:table-cell}}html{font-family:"Montserrat",sans-serif;--font-family: "Montserrat", sans-serif}button{max-width:100%;background:#f2f2f2;color:#191919;cursor:pointer;display:inline-block;padding:.75em 1.5em;text-align:center;margin:0 .75em 1.5em 0}button:hover{background:#d9d9d9;color:#000}button:not([disabled]){background:#f9c412;color:#181818;background:var(--primary)}button:not([disabled]):hover{background:#ba9005;color:#000;background:var(--primary-dark)}*{border:0;box-sizing:border-box}body,header nav a{font-family:var(--font-family)}body{background:var(--bg-color);color:var(--text-color)}header{padding:4em 1.5em 3em;width:37.5em;margin:0 auto;text-align:center;max-width:100%;display:flex;align-items:center;flex-direction:column}header p{margin-top:0}header nav h1{float:left;font-size:inherit;line-height:inherit;margin:0;text-align:left}header nav a{font-weight:700;text-decoration:none;color:var(--nav-text-color);margin-left:1.5em;font-family:'CyberwayRiders';text-shadow:0 0 7px #fff,0 0 42px #0a9cf5}header nav a:first-of-type{margin-left:auto}header nav a:last-of-type{margin-right:1.5em}main{max-width:70rem;margin:0 auto}footer{background:var(--footer-bg-color);color:var(--footer-text-color);padding:3em;text-align:center}footer>*{font-family:'CyberwayRiders';text-shadow:0 0 7px #fff,0 0 42px #0a9cf5}footer nav a img{vertical-align:middle}footer nav,footer p{font-size:90%}article{max-width:100%;padding:0 1.5em;width:37.5em;margin:0 auto;min-height:100vh}blockquote{border-left:1px solid #f9c412;padding:0 1.5em;margin:1.5em 0 1.5em 1.5em;border-left:1px solid var(--primary)}blockquote footer{background:0 0;display:block;color:#ccc;padding:.75em 0;font-size:90%;text-align:start}figure,footer>*{margin:1.5em}figure img{display:block}code[class*=language-],pre[class*=language-]{color:#ccc;background:0 0;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]{padding:0}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.tag{color:#e2777a}.token.boolean,.token.function,.token.number{color:#f08d49}.token.property{color:#f8c555}.token.builtin,.token.keyword{color:#cc99cd}.token.string,.token.variable{color:#7ec699}.token.operator,.token.url{color:#67cdcc}.token.inserted{color:green}.about,.tags{min-height:80vh}.about h1{font-family:'CyberwayRiders';padding-bottom:1em}article h1{text-shadow:0 0 7px #fff,0 0 42px #0a9cf5}.tags h1,article h1{font-family:'CyberwayRiders';padding-bottom:1em;text-align:center}@media (min-width:600px){.about,.tags{min-height:calc(100vh - 360px)}}.post{margin-bottom:30px}.post .title{font-weight:700;color:var(--primary)}.post .description{margin-top:5px;color:var(--text-color)}</style><header><nav><div id=nav><h1><a href=/ title=Homepage>The Fortune Days</a></h1><a href=/tags/ >Tags</a> <a href=/about/ >About</a></div><div id=reading-progress aria-hidden=true></div></nav><dialog id=message></dialog></header><main><article><h1>Interface Explained</h1><p><img alt="What is interface?" height=338 src=/img/remote/articles/go-interface/go-interface-intro.svg width=560><p><strong>Summary</strong>: Interface values are stored as eface & iface during runtime. Go keeps track of struct & interface mapping in an internal list called itabTable. This list is built both at compile time and at runtime and will be used for checking if a struct implements an interface.<p><em>Note: this post is to explain the illustration that I have in my previous post <a href=https://pthethanh.herokuapp.com/blog/articles/golang-interface>interface{}</a>.</em><p>Interface is the most interesting in Go which differentiates it from the other programming languages. Most of us use it a lot in our code but it seems not everybody understands how it works under the hood. In this post I will dig into the code of the runtime a little bit to see how it works. To avoid the complexity, the code shown in this post might hide some detail from the real code.<p>The most interesting thing about interface in Go is that it is just a set of method signatures. Or we can think of it as a set of behaviors we expect from a dependency (<em>some people might call it as a <code>contract</code> between two or more components</em>). Let's take a look at the <code>fmt.Stringer</code> interface.<pre class=language-go><code class=language-go><span class="token keyword">type</span> Stringer <span class="token keyword">interface</span> <span class="token punctuation">{</span><br>	<span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span><br><span class="token punctuation">}</span></code></pre><p>For a struct to be called as <code>implements</code> the fmt.Stringer interface, what it needs is just having the same method signature with the interface.<pre class=language-go><code class=language-go><span class="token keyword">type</span> Number <span class="token builtin">int</span><br><br><span class="token keyword">func</span> <span class="token punctuation">(</span>n Number<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span><br>	<span class="token keyword">return</span> strconv<span class="token punctuation">.</span><span class="token function">Itoa</span><span class="token punctuation">(</span><span class="token function">int</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>It's just as simple as that! A struct is called <code>implements</code> an interface when and only when it defines the same set of method signatures that the interface defines. In this manner, the Go interface is really a duck typing.<blockquote><p>If it walks like a duck and it quacks like a duck, then it must be a duck<p>wikipedia</blockquote><p>Requiring no explicit declaration at compile time makes the Go interface really powerful compared to other programming languages like Java. Java requires an explicit keyword implements on the class declaration at compile time, and this means you have to import the library that defines the interface and all of its dependencies just to implement it:<pre class=language-go><code class=language-go><span class="token keyword">import</span> fmt<span class="token punctuation">.</span>Stringer<span class="token punctuation">;</span><br><br>public class MyObject implements Stringer <span class="token punctuation">{</span><br>  public String <span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>With a language like Java, it's easy for the compiler and the runtime to know if a class implements an interface or not since it has the explicit <code>implements</code> keyword in the class and can easily build a mapping table to check both at compile time and runtime. But Go doesn't require any explicit declaration, how does it check if a type implements an interface? Does it happen at compile time? Or does it happen at runtime?<p>The answer is both! Go checks type conversion at compile time for explicit conversions and checks at runtime for implicit conversions.<p>That means the below explicit conversion will be checked at compile time:<pre class=language-go><code class=language-go><span class="token keyword">var</span> str fmt<span class="token punctuation">.</span>Stringer <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// check at compile time.</span></code></pre><p>But for any implicit conversion like the following block of code, the check will be done at runtime when that specific block of code is invoked:<pre class=language-go><code class=language-go><span class="token keyword">func</span> <span class="token function">printIt</span><span class="token punctuation">(</span>v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token keyword">if</span> v<span class="token punctuation">,</span> ok <span class="token operator">:=</span> v<span class="token punctuation">.</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span>Stringer<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span> <span class="token comment">// check at runtime.</span><br>		<span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>		<span class="token keyword">return</span><br>	<span class="token punctuation">}</span><br>	<span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>For both the compile time and runtime type conversion checks, the information will be stored in an internal list called <code>itabTable</code>. This itabTable list keeps track information of all the type conversions and assertions. It's organized and used as a cache for speeding up the performance of any future type conversion and assertions.<p>To understand the itabTable, let's take a look at the type system in the runtime first.<p>In the runtime, the all the supported types are defined in <a href=https://golang.org/src/runtime/type.go>runtime/type.go</a> and <a href=https://golang.org/src/runtime/typekind.go>runtime/typekind.go</a>, these types cover all the basic types as well as struct and interface types:<pre class=language-go><code class=language-go>kindBool<br>kindInt<br><span class="token operator">...</span><br>kindFloat64<br>kindArray<br>kindChan<br>kindFunc<br><span class="token operator">...</span><br>kindInterface<br>kindStruct<br><span class="token operator">...</span><span class="token punctuation">.</span></code></pre><p>During runtime, interface values will be stored in an <code>eface</code> if it's an empty interface, or in an <code>iface</code> if it has methods. The <code>_type</code> holds information of the type of the value the interface is holding, and the <code>data</code> is a pointer to the real data. In case of the <code>iface</code>, the <code>itab</code> holds information of both the interface and its target type, and the <code>fun[0]</code> indicates whether the type implements the interface or not. fun[0]!=0 means the type implements the interface.<pre class=language-go><code class=language-go><span class="token keyword">type</span> iface <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>	tab  <span class="token operator">*</span>itab<br>	data unsafe<span class="token punctuation">.</span>Pointer<br><span class="token punctuation">}</span><br><br><span class="token keyword">type</span> eface <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>	_type <span class="token operator">*</span>_type<br>	data  unsafe<span class="token punctuation">.</span>Pointer<br><span class="token punctuation">}</span><br><br><span class="token keyword">type</span> itab <span class="token keyword">struct</span> <span class="token punctuation">{</span><br>	inter <span class="token operator">*</span>interfacetype<br>	_type <span class="token operator">*</span>_type<br>    <span class="token operator">...</span><br>    <span class="token operator">...</span><br>	fun   <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token builtin">uintptr</span> <span class="token comment">// variable sized. fun[0]==0 means _type does not implement inter.</span><br><span class="token punctuation">}</span></code></pre><p>The below figure show how the types are structured in the runtime:<p><img alt="Interface Explained" height=1078 src=/img/remote/articles/go-interface/go-interface-explained.svg width=561><p>So, the <code>itab</code> is used for holding the mapping between an interface and a struct, and holds information whether the struct implements the interface or not via its property: fun[0]. Let's take a look at the process of building the itab and the itabTable.<p>Consider the below block of code, where there is a type conversion between an interface and a struct:<pre class=language-go><code class=language-go><span class="token keyword">var</span> str fmt<span class="token punctuation">.</span>Stringer <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre><p>The above block of code would trigger a type conversion of runtime code and the method <code>getitab</code> would be called during that process (see <a href=https://golang.org/src/runtime/iface.go>runtime/iface.go</a>). Basically, getitab would first look for the information in the itabTable, if the information is not there, it would construct a new itab and will store it back to the itabTable for future check. The below figure show how the itab is constructed:<p><img alt=itable height=1030 src=/img/remote/articles/go-interface/go-itable.svg width=556><p>As we can see in the above figure, Go runtime would scan through the interface and the struct to extract their method definitions and then just simply compare them to see if they match. If the method signatures matched, we can say that the struct implements the interface.<p>The process is exactly the same for both type conversions that happen at compile time and runtime. For more detail on how the check happens, the best place to start with is the method <code>getitab</code> in <a href=https://golang.org/src/runtime/iface.go>runtime/iface.go</a>.<p>For those who want to debug the Go runtime, the below snip of code is the code that I used for printing the information of the itabTable for debugging purpose:<pre class=language-go><code class=language-go><span class="token keyword">func</span> <span class="token punctuation">(</span>itab <span class="token operator">*</span>itab<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Type      :"</span><span class="token punctuation">,</span> itab<span class="token punctuation">.</span>_type<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>itab<span class="token punctuation">.</span>_type<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Interface :"</span><span class="token punctuation">,</span> itab<span class="token punctuation">.</span>inter<span class="token punctuation">.</span>typ<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>itab<span class="token punctuation">.</span>inter<span class="token punctuation">.</span>typ<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Fun[0]:"</span><span class="token punctuation">,</span> itab<span class="token punctuation">.</span>fun<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">func</span> <span class="token punctuation">(</span>inter <span class="token operator">*</span>interfacetype<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Interface :"</span><span class="token punctuation">,</span> inter<span class="token punctuation">.</span>typ<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>inter<span class="token punctuation">.</span>typ<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> mt <span class="token operator">:=</span> <span class="token keyword">range</span> inter<span class="token punctuation">.</span>mhdr <span class="token punctuation">{</span><br>		name <span class="token operator">:=</span> inter<span class="token punctuation">.</span>typ<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>mt<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>		typ <span class="token operator">:=</span> inter<span class="token punctuation">.</span>typ<span class="token punctuation">.</span><span class="token function">typeOff</span><span class="token punctuation">(</span>mt<span class="token punctuation">.</span>ityp<span class="token punctuation">)</span><br>		<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"    Method:"</span><span class="token punctuation">,</span> name<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> typ<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>typ<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// print type info</span><br><span class="token keyword">func</span> <span class="token punctuation">(</span>typ <span class="token operator">*</span>_type<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Type: "</span> <span class="token operator">+</span> typ<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>typ<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>	x <span class="token operator">:=</span> typ<span class="token punctuation">.</span><span class="token function">uncommon</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>	<span class="token comment">// fields</span><br>	<span class="token keyword">switch</span> typ<span class="token punctuation">.</span>kind <span class="token operator">&</span> kindMask <span class="token punctuation">{</span><br>	<span class="token keyword">case</span> kindStruct<span class="token punctuation">:</span><br>		st <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span>structtype<span class="token punctuation">)</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Pointer</span><span class="token punctuation">(</span>typ<span class="token punctuation">)</span><span class="token punctuation">)</span><br>		<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> f <span class="token operator">:=</span> <span class="token keyword">range</span> st<span class="token punctuation">.</span>fields <span class="token punctuation">{</span><br>			<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"        Field : "</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>typ<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>		<span class="token punctuation">}</span><br>	<span class="token punctuation">}</span><br>	<span class="token comment">// methods</span><br>	nt <span class="token operator">:=</span> <span class="token function">int</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>mcount<span class="token punctuation">)</span><br>	methods <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">]</span>method<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span>unsafe<span class="token punctuation">.</span><span class="token function">Pointer</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">uintptr</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>moff<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>nt<span class="token punctuation">:</span>nt<span class="token punctuation">]</span><br>	j <span class="token operator">:=</span> <span class="token number">0</span><br>	<span class="token keyword">if</span> nt <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span><br>		<span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>	<span class="token punctuation">}</span><br>	<span class="token keyword">for</span> <span class="token punctuation">;</span> j <span class="token operator">&lt;</span> nt<span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">{</span><br>		t <span class="token operator">:=</span> <span class="token operator">&</span>methods<span class="token punctuation">[</span>j<span class="token punctuation">]</span><br>		name <span class="token operator">:=</span> typ<span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>		typ <span class="token operator">:=</span> typ<span class="token punctuation">.</span><span class="token function">typeOff</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>mtyp<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nameOff</span><span class="token punctuation">(</span>typ<span class="token punctuation">.</span><span class="token function">typeOff</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>mtyp<span class="token punctuation">)</span><span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>		<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"        Method: "</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> typ<span class="token punctuation">)</span><br>	<span class="token punctuation">}</span><br>	<span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre><p>And this is how the itabTable can be printed:<pre class=language-go><code class=language-go><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> itab <span class="token operator">:=</span> <span class="token keyword">range</span> itabTable<span class="token punctuation">.</span>entries <span class="token punctuation">{</span><br>	<span class="token keyword">if</span> itab <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span><br><br>		itab<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>	<span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>So, that's a quick overview of how the interface values are stored and how interface conversion works during the runtime. There are still a lot of interesting things in the Go runtime and we will explore more in the future posts.</p><share-widget><button aria-label=Share href=https://thefortunedays.com/articles/go-interface/ on-click=share><div></div></button></share-widget><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"Interface Explained","image":["https://thefortunedays.com/img/remote/articles/go-interface/go-interface-intro.svg","https://thefortunedays.com/img/remote/articles/go-interface/go-interface-explained.svg","https://thefortunedays.com/img/remote/articles/go-interface/go-itable.svg"],"author":"Thanh","genre":"Blog","publisher":{"@type":"Organization","name":"Thanh","logo":{"@type":"ImageObject","url":"/img/favicon/favicon-192x192.png?hash=735479e2c4"}},"url":"https://thefortunedays.com/articles/go-interface/","mainEntityOfPage":"https://thefortunedays.com/articles/go-interface/","datePublished":"2021-10-28","dateModified":"2024-09-24","description":"Summary: Interface values are stored as eface &amp;amp; iface during runtime. Go keeps track of struct &amp;amp; interface mapping in an internal..."}</script></article></main><footer><a href=/about/ >Thanh</a></footer>