const article={message:"",article:{community_id:"",article_id:"",content:{}},editor:{},init(e){this.article.community_id=e,this.initEditor()},initEditor(){let e=window.location.pathname;if("/blog/new-article"===e)return void(this.editor=createEditor({}));let t=(e=window.location.pathname.substring("articles/".length+1)).substring(0,e.indexOf("/"));fetch("/api/v1/communities/"+this.article.community_id+"/articles/x/"+t,{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{this.article=e.article,this.editor=createEditor(e.article.content)}).catch(e=>{this.message="Error: "+e})},save(){this.editor.save().then(e=>{for(i=0;i<e.blocks.length;i++){let t="Raw";switch(e.blocks[i].type){case"header":t="Header";break;case"list":t="List";break;case"embed":t="Embed";break;case"table":t="Table";break;case"responsive_image":t="ResponsiveImage";break;case"raw":t="Raw";break;case"paragraph":t="Paragraph";break;case"image":t="Image";break;case"simpleImage":t="SimpleImage";break;case"quote":t="Quote";break;case"code":t="Code";break;case"delimiter":t="Delimiter";break;case"title":t="Title";break;case"introduction":t="Introduction";break;case"summary":t="Summary";break;case"tag":t="Tag";break;case"keyword":t="Keyword";break;case"nestedList":t="NestedList";break;default:t="Raw"}e.blocks[i].data["@type"]="type.googleapis.com/article."+t}this.article.content=e,""!==this.article.article_id?this.update():this.create()})},create(){this.message="Saving...",this.article.status=1,fetch("/api/v1/communities/"+this.article.community_id+"/articles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({article:this.article})}).then(e=>e.json()).then(e=>{e.code?this.message="Error: "+e.message:(this.message="Saved",this.article.article_id=e.article_id,this.article.id=e.id,window.history.pushState({},null,"/articles/"+this.article.article_id+"/edit"))}).catch(e=>{this.message="Error: "+e})},update(){this.message="Saving...",fetch("/api/v1/communities/"+this.article.community_id+"/articles/"+this.article.id,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({article:{article_id:this.article.article_id,content:this.article.content},update_mask:["content","tags","keywords","title","summary","introduction","cover_image"]})}).then(e=>e.json()).then(e=>{e.code>0&&200!=e.code?this.message=e.error:this.message="Saved"}).catch(e=>{this.message="Error: "+e})},publish(){this.message="Publishing...",fetch("/api/v1/communities/"+this.article.community_id+"/articles/"+this.article.id,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({article:{article_id:this.article.article_id,status:2,published_at:new Date},update_mask:["status","published_at"]})}).then(e=>e.json()).then(e=>{this.message="Published"}).catch(e=>{this.message="Error: "+e})},deleteArticle(){this.message="Deleting...",fetch("/api/v1/communities/"+this.article.community_id+"/articles/"+this.article.id,{method:"DELETE"}).then(e=>e.json()).then(e=>{e.code>0&&200!=e.code?this.message=e.error:this.message="Deleted"}).catch(e=>{this.message="Error: "+e})},makePrivate(){this.message="Updating to private mode...",fetch("/api/v1/communities/"+this.article.community_id+"/articles/"+this.article.id,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({article:{article_id:this.article.article_id,status:1},update_mask:["status"]})}).then(e=>e.json()).then(e=>{this.message="Updated"}).catch(e=>{this.message="Error: "+e})}};function createEditor(e){return new EditorJS({holder:"editor",autofocus:!0,placeholder:"Let's write your awesome story!",data:e,defaultBlock:"paragraph",tools:{title:{class:Header,inlineToolbar:!0,toolbox:{title:"Title"},config:{placeholder:"Title",levels:[1],defaultLevel:1}},paragraph:{class:Paragraph,inlineToolbar:!0,toolbox:{title:"Text"}},header:{class:Header,inlineToolbar:!0,config:{placeholder:"Header",levels:[2,3,4],defaultLevel:2}},introduction:{class:AnyText,inlineToolbar:!0,toolbox:{title:"Introduction"},config:{class:"edt-introduction"}},tag:{class:AnyText,inlineToolbar:!0,toolbox:{title:"Tags"},config:{class:"edt-tag"}},keyword:{class:AnyText,inlineToolbar:!0,toolbox:{title:"Keywords"},config:{class:"edt-keyword"}},summary:{class:AnyText,inlineToolbar:!0,toolbox:{title:"Summary"},config:{class:"edt-summary"}},Color:{class:window.ColorPlugin,config:{colorCollections:["#E53E3E","#F56565","#FC8181","#DD6B20","#ED8936","#F6AD55","#D69E2E","#ECC94B","#F6E05E","#38A169","#48BB78","#68D391","#319795","#38B2AC","#4FD1C5","#3182CE","#4299E1","#63B3ED","#5A67D8","#667EEA","#7F9CF5","#805AD5","#9F7AEA","#B794F4","#D53F8C","#ED64A6","#F687B3","#1A202C","#718096","#A0AEC0","#FFFFFF"],defaultColor:"#E53E3E",type:"text"}},Marker:{class:window.ColorPlugin,config:{colorCollections:["#E53E3E","#F56565","#FC8181","#DD6B20","#ED8936","#F6AD55","#D69E2E","#ECC94B","#F6E05E","#38A169","#48BB78","#68D391","#319795","#38B2AC","#4FD1C5","#3182CE","#4299E1","#63B3ED","#5A67D8","#667EEA","#7F9CF5","#805AD5","#9F7AEA","#B794F4","#D53F8C","#ED64A6","#F687B3","#1A202C","#718096","#A0AEC0","#FFFFFF"],defaultColor:"#F6E05E",type:"marker"}},nestedList:{class:NestedList,inlineToolbar:!0},simpleImage:{class:SimpleImage,inlineToolbar:!0},quote:{class:Quote,inlineToolbar:!0,shortcut:"CMD+SHIFT+O",config:{quotePlaceholder:"Enter a quote",captionPlaceholder:"Quote's author"}},code:{class:CodeTool,shortcut:"CMD+SHIFT+C"},inlineCode:{class:InlineCode,shortcut:"CMD+SHIFT+M"},delimiter:{class:Delimiter,inlineToolbar:!0},embed:{class:Embed},raw:RawTool,responsive_image:{class:AnyTool,inlineToolbar:!0,config:{data:{src:"mobile.jpg",srcset:"mobile.jpg,desktop.jpg",caption:""}},toolbox:{title:"Responsive Images",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>'}},table:{class:AnyTool,inlineToolbar:!0,config:{data:{header:["col1","col2"],content:[["value 1","value 2"],["value 3","value 4"]]}},toolbox:{title:"Table",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>'}}}})}